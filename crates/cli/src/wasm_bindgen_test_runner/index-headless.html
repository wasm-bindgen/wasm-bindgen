<!DOCTYPE html>
<html>
  <head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type"/>
  </head>
  <body>
    <pre id="output" style="display:none">Loading scripts...</pre>
    <pre id="console_debug" style="display:none"></pre>
    <pre id="console_log" style="display:none"></pre>
    <pre id="console_info" style="display:none"></pre>
    <pre id="console_warn" style="display:none"></pre>
    <pre id="console_error" style="display:none"></pre>
    <script>
     const orig = id => (...args) => {
         const logs = document.getElementById(id);
         for (const msg of args) {
             logs.appendChild(document.createTextNode(`${msg}\n`));
         }
     };

     // {NOCAPTURE}
     const wrap = method => {
         const og = orig(`console_${method}`);
         const on_method = `on_console_${method}`;
         console[method] = function (...args) {
             if (nocapture) {
                 orig("output").apply(this, args);
             }
             if (window[on_method]) {
                 window[on_method](args);
             }
             og.apply(this, args);
         };
     };

     wrap("debug");
     wrap("log");
     wrap("info");
     wrap("warn");
     wrap("error");

     window.__wbg_test_invoke = f => f();
    </script>
    <!-- {IMPORT_SCRIPTS} -->
  </body>
</html>
